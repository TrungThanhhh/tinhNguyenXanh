@using TinhNguyenXanh.Models.ViewModel
@model SearchResultsViewModel

<style>
    /* CSS tùy chỉnh để làm đẹp và đồng nhất thẻ */
    .card {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }

    .card-title {
        height: 3em; /* Cố định chiều cao cho 2 dòng tiêu đề */
        overflow: hidden;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }

    /* Đảm bảo chiều cao ảnh đồng nhất */
    .event-image {
        height: 200px;
        object-fit: cover;
    }

    .org-image {
        height: 150px;
        object-fit: cover;
    }

    /* Thẻ cảnh báo khi không có kết quả */
    .alert-custom {
        padding: 30px;
        margin-bottom: 20px;
        border: 1px dashed #ced4da;
        background-color: #f8f9fa;
        color: #6c757d;
        border-radius: 8px;
    }

</style>

<div class="container mt-4">
    <div class="text-center mb-5">
        <h2 class="fw-bold text-success">Kết quả tìm kiếm</h2>
        <p class="text-muted">
            Tìm thấy <strong>@(Model.Events.Count + Model.Organizations.Count)</strong> kết quả cho từ khóa: "<strong>@Model.Keyword</strong>"
        </p>
    </div>

    <div class="row g-5">

        <div class="col-lg-6">
            <h4 class="mb-4 text-success"><i class="bi bi-calendar-event me-2"></i> Sự kiện tình nguyện (@Model.Events.Count)</h4>
            <div class="row g-4">
                @if (Model.Events.Any())
                {
                    @foreach (var e in Model.Events)
                    {
                        <div class="col-12">
                            <div class="card h-100 shadow-sm border-0 rounded-4">
                                <div class="row g-0">
                                    <div class="col-md-5">
                                        <img src="@(string.IsNullOrEmpty(e.Images) ? "/images/default-event.jpg" : e.Images)"
                                             class="img-fluid rounded-start-4 event-image" alt="@e.Title" />
                                    </div>
                                    <div class="col-md-7">
                                        <div class="card-body d-flex flex-column">
                                            <h6 class="card-title fw-bold text-success">@e.Title</h6>
                                            <p class="card-text text-muted small mb-2">
                                                <i class="bi bi-geo-alt me-1"></i> @e.Location
                                            </p>
                                            <p class="card-text text-muted small mb-2">
                                                <i class="bi bi-calendar-event me-1"></i>
                                                @e.StartTime.ToString("dd/MM/yyyy HH:mm")
                                            </p>
                                            <div class="mt-auto pt-2">
                                                <span class="badge bg-success mb-2">@e.Category?.Name</span>
                                                <a asp-controller="Event" asp-action="Details" asp-route-id="@e.Id" class="btn btn-outline-success btn-sm float-end">
                                                    Xem chi tiết
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="col-12">
                        <div class="alert-custom text-center">
                            <i class="bi bi-info-circle display-6 mb-2"></i>
                            <p class="mb-0">Không tìm thấy sự kiện nào phù hợp.</p>
                        </div>
                    </div>
                }
            </div>
        </div>

        <div class="col-lg-6">
            <h4 class="mb-4 text-primary"><i class="bi bi-building me-2"></i> Tổ chức (@Model.Organizations.Count)</h4>
            <div class="row g-4">
                @if (Model.Organizations.Any())
                {
                    @foreach (var org in Model.Organizations)
                    {
                        <div class="col-12">
                            <div class="card h-100 shadow-sm border-0 rounded-4">
                                <div class="row g-0">
                                    <div class="col-md-5">
                                        <img src="@(string.IsNullOrEmpty(org.AvatarUrl) ? "/images/default-org.png" : org.AvatarUrl)"
                                             class="img-fluid rounded-start-4 org-image" alt="@org.Name" />
                                    </div>
                                    <div class="col-md-7">
                                        <div class="card-body d-flex flex-column">
                                            <h6 class="card-title fw-bold text-primary">@org.Name</h6>
                                            @if (org.Verified)
                                            {
                                                <span class="badge bg-primary mb-2">
                                                    <i class="bi bi-shield-check me-1"></i> Đã xác thực
                                                </span>
                                            }
                                            <p class="card-text text-muted small mb-2">
                                                <i class="bi bi-geo-alt me-1"></i> @org.Address
                                            </p>
                                            <div class="mt-auto pt-2">
                                                <a asp-controller="Organization" asp-action="Details" asp-route-id="@org.Id" class="btn btn-outline-primary btn-sm float-end">
                                                    Xem hồ sơ
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="col-12">
                        <div class="alert-custom text-center">
                            <i class="bi bi-building display-6 mb-2"></i>
                            <p class="mb-0">Không tìm thấy tổ chức nào phù hợp.</p>
                        </div>
                    </div>
                }
            </div>
        </div>

    </div>

    <div class="text-center mt-5">
        <a asp-controller="Home" asp-action="Index" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left me-2"></i> Quay về trang chủ
        </a>
    </div>
</div>